{"name":"breadcrumbsSceneConfig","type":"script","scope":"global","author":"enbSZFWzu5dUH8Ji","img":"icons/svg/dice-target.svg","command":"const currentScene = game.scenes.current\n\nconst loadoutsTileDialog = new Dialog({\n    title: \"Breadcrumbs\", \n    content:`\n    <script>\n        async function fileBrowser() {\n            const path = '` + game.settings.get(\"breadcrumbs\", \"breadcrumbs-default-image\") + `';\n            new FilePicker({\n                type: 'image',\n                current: path,\n                callback: imagePath => {\n                    document.getElementById(\"breadcrumbsImagePreview\").src = imagePath;\n                },\n            }).browse();\n    }\n    </script>\n    <script type=\"text/javascript\">\n        function limitTrailLength(obj){\n            if (obj.value.length > 2){\n                obj.value = obj.value.slice(0,2); \n            }\n        }\n    </script>\n    <form class=\"form-horizontal\">\n    <fieldset>\n    \n    <!-- Form Name -->\n    <legend>Scene Configuration</legend>\n\n    <!-- Boolean input-->\n    <div class=\"form-group\">\n      <label class=\"col-md-4 control-label\" for=\"enableBreadcrumbs\">Enable Breadcrumbs</label>  \n      <div class=\"col-md-4\">\n      <input id=\"enableBreadcrumbs\" name=\"enableBreadcrumbs\" type=\"checkbox\" checked></input>\n      </div>\n    </div>\n    \n    <div class=\"form-group\">\n        <label>Breadcrumbs Image</label>\n        <button onclick=\"fileBrowser()\">\n            <img id=\"breadcrumbsImagePreview\" src=\"` + game.settings.get(\"breadcrumbs\", \"breadcrumbs-default-image\") + `\" style=\"width: 50px; height: 50px;\">\n        </button>\n    </div>\n\n    <!-- Range input-->\n    <div class=\"form-group\">\n      <label class=\"col-md-4 control-label\" for=\"breadcrumbsScale\">Breadcrumbs Scale</label>  \n      <div class=\"col-md-4\">\n      <input id=\"breadcrumbsScale\" name=\"breadcrumbsScale\" type=\"range\" min=\"0.1\" max=\"1\" step=\"0.1\" defaultValue=\"1\" value=\"1\" oninput=\"document.getElementById('rangeValLabel').innerHTML = this.value;\"></input>\n      <span class=\"help-block\">Scale: </span>\n      <em id=\"rangeValLabel\" style=\"font-style: normal;\">1</em>\n      </div>\n    </div>\n\n    <div class=\"form-group\">\n      <label for=\"trailLength\">Trail Length Max</label>\n      <input type=\"number\" id=\"trailLength\" name=\"trailLength\" value=\"` + game.settings.get(\"breadcrumbs\", \"breadcrumbs-default-trail-length\") + `\" min=\"0\" max=\"99\" oninput=\"limitTrailLength(this)\">\n    </div>\n    `,\n      buttons: {\n        cancel: {\n            icon: \"<i class='fas fa-check'></i>\",\n            label: `Cancel`,\n            callback: function(){ return; }  \n            },\n        apply: {\n            icon: \"<i class='fas fa-check'></i>\",\n            label: `Apply Changes` ,\n            callback: html => {setupBreadcrumbsScene(\n                html.find('[name=\"enableBreadcrumbs\"]').val(),\n                html.find(\"#breadcrumbsImagePreview\").attr(\"src\"),\n                html.find('[name=\"breadcrumbsScale\"]').val(),\n                html.find('[name=\"trailLength\"]').val()\n            )}   \n            }\n      },\n      default: 'apply',\n}).render(true);\n\nasync function setupBreadcrumbsScene(enableBreadcrumbs, breadcrumbsImage, breadcrumbsScale, trailLength){\n    currentScene.update({\n        \"flags.breadcrumbs\": {\n            \"enabled\": enableBreadcrumbs,\n            \"image\": breadcrumbsImage,\n            \"scale\": breadcrumbsScale,\n            \"trails\": {\n                \"length\": {\n                    max: Number(trailLength)\n                }\n\n            }\n        }\n    });\n};","flags":{"core":{"sourceId":"Macro.16Vux8Qdq7rpmOLn"}},"_stats":{"systemId":"cyberpunk-red-core","systemVersion":"v0.87.6","coreVersion":"10.303","createdTime":1695319496688,"modifiedTime":1695331366090,"lastModifiedBy":"enbSZFWzu5dUH8Ji"},"folder":null,"sort":0,"ownership":{"default":0,"enbSZFWzu5dUH8Ji":3},"_id":"PcFpIFbVhGEvOqAe"}
